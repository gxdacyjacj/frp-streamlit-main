# ğŸ“‹ Dataset Code åŸå§‹åˆ—æå–æ˜ å°„è¡¨

## ğŸ¯ åŸå§‹ dataset codeï¼ˆexcel to SQLï¼‰.py çš„åˆ—æå–æ–¹å¼

### **æ ¸å¿ƒæ–¹æ³•ï¼šç®€å•ä½ç½®æå–**
```python
# è¯»å–Excelï¼ˆheader=3ï¼Œå³ç¬¬4è¡Œä½œä¸ºåˆ—åï¼‰
df = pd.read_excel(EXCEL_FILE_PATH, header=3, engine='openpyxl')

# ç®€å•ç²—æš´ï¼šåªå–å‰132åˆ—
df = df.iloc[:, :132]
```

### **132åˆ—ç‰¹å¾çš„ä½ç½®æ˜ å°„**

**åŸå§‹ä»£ç å‡è®¾ï¼šåŸºäºdatabase 1.xlsxæ ¼å¼ï¼Œå‰132åˆ—å°±æ˜¯æ‰€éœ€çš„å…¨éƒ¨ç‰¹å¾**

| ä½ç½® | æ•°æ®åº“å­—æ®µå | å¯¹åº”Excelåˆ—å (database 1.xlsx) | è¯´æ˜ |
|------|-------------|--------------------------------|------|
| 1 | `feature_name` | `feature_name` | ç‰¹å¾åç§° |
| 2 | `Title` | `Title` | è®ºæ–‡æ ‡é¢˜ |
| 3 | `Author` | `Author` | ä½œè€… |
| 4 | `SCI` | `SCI` | SCIæœŸåˆŠæ ‡è¯† |
| 5 | `Journal_or_Conference_name` | `Journal_or_Conference_name` | æœŸåˆŠåç§° |
| ... | ... | ... | ... |
| 33 | `num_1` | `num` | æ•°é‡1 |
| ... | ... | ... | ... |
| 71 | `number_field` | `number` | **å…³é”®ï¼šBUç›¸å…³å­—æ®µ** |
| 72 | `type_field` | `type` | ç±»å‹å­—æ®µ |
| 73 | `SolutionorMoisture` | `SolutionorMoisture` | **BUåˆ—ï¼šSMDè¿‡æ»¤** |
| ... | ... | ... | ... |
| 95 | `num_2` | `num.1` | æ•°é‡2 |
| ... | ... | ... | ... |
| 132 | `important_note` | `important_note` | é‡è¦æ³¨é‡Š |

## ğŸš¨ **é—®é¢˜æ‰€åœ¨ï¼šdatabase 4.xlsxçš„åˆ—åç§»**

### **åŸå§‹ä»£ç çš„é—®é¢˜**
```python
# è¿™ä¸ªæ–¹æ³•å¯¹database 4.xlsxæ˜¯é”™è¯¯çš„ï¼
df = df.iloc[:, :132]  # åªå–å‰132åˆ—
```

**ä¸ºä»€ä¹ˆé”™è¯¯ï¼Ÿ**
- database 4.xlsxåœ¨ç¬¬71-72åˆ—æ’å…¥äº†æ–°åˆ—ï¼š`pH.2` å’Œ `Ingrediant`
- å¯¼è‡´ç¬¬73åˆ—å¾€åçš„æ‰€æœ‰åˆ—éƒ½å‘ååç§»2ä½
- åŸå§‹ä»£ç å–çš„å‰132åˆ—ï¼Œå®é™…ä¸Š**ç¼ºå¤±äº†æœ€å2åˆ—çš„ç‰¹å¾**ï¼

### **å…·ä½“åç§»å¯¹æ¯”**

| ç‰¹å¾ | database 1.xlsxä½ç½® | database 4.xlsxä½ç½® | åç§»é‡ |
|------|-------------------|-------------------|-------|
| `number` | ç¬¬71åˆ— | ç¬¬73åˆ— | +2 |
| `type` | ç¬¬72åˆ— | ç¬¬74åˆ— | +2 |
| `SolutionorMoisture` | ç¬¬73åˆ— | ç¬¬75åˆ— | +2 |
| `num.1` | ç¬¬95åˆ— | ç¬¬97åˆ— | +2 |
| `important_note` | ç¬¬132åˆ— | ç¬¬134åˆ— | +2 |

### **åŸå§‹ä»£ç æå–ç»“æœå¯¹æ¯”**

#### **database 1.xlsxï¼ˆæ­£ç¡®ï¼‰**
```
ä½ç½®1-132 â†’ æ­£ç¡®çš„132ä¸ªç‰¹å¾ âœ…
```

#### **database 4.xlsxï¼ˆé”™è¯¯ï¼‰**
```
ä½ç½®1-70:   æ­£ç¡®çš„å‰70ä¸ªç‰¹å¾ âœ…
ä½ç½®71-72:  é”™è¯¯ï¼æå–äº†æ–°å¢çš„ pH.2, Ingrediant âŒ 
ä½ç½®73-132: é”™è¯¯ï¼æå–äº†åç§»åçš„60ä¸ªç‰¹å¾ âŒ
ç¼ºå¤±ï¼š     æœ€å2ä¸ªç‰¹å¾ (FTIR_2, important_note) âŒ
```

## ğŸ”§ **æˆ‘çš„æ™ºèƒ½è½¬æ¢å™¨è§£å†³æ–¹æ¡ˆ**

### **æ™ºèƒ½åˆ—æ˜ å°„æ–¹å¼**
```python
# 1. æ£€æµ‹æ ¼å¼
if df.columns[70] == 'pH.2':  # database 4æ ¼å¼
    # å‰70åˆ—ç›´æ¥æ˜ å°„
    # ç¬¬71åˆ—å¾€åï¼šåç§»+2ä½æ˜ å°„
else:  # database 1æ ¼å¼
    # ç›´æ¥æŒ‰ä½ç½®æ˜ å°„
```

### **ç¡®ä¿ç›¸åŒç‰¹å¾æå–**
```python
# åŸºäºåˆ—åè€Œéä½ç½®çš„æ™ºèƒ½æ˜ å°„
for i, std_col in enumerate(STANDARD_COLUMNS):
    if is_database4_format and i >= 70:
        target_idx = i + 2  # åç§»å¤„ç†
    else:
        target_idx = i
    
    if target_idx < len(df.columns):
        column_mapping[std_col] = target_idx
```

## âœ… **éªŒè¯ç»“æœ**

### **ä¸¤ç§æ ¼å¼éƒ½è¾“å‡ºç›¸åŒçš„132åˆ—ç‰¹å¾**
- âœ… database 1.xlsx: 5,094è¡Œ Ã— 132åˆ—æ ‡å‡†ç‰¹å¾
- âœ… database 4.xlsx: 5,959è¡Œ Ã— 132åˆ—æ ‡å‡†ç‰¹å¾
- âœ… ç‰¹å¾å®Œå…¨ç›¸åŒï¼Œåªæ˜¯æ•°æ®é‡ä¸åŒ

### **å…³é”®BUåˆ—æ­£ç¡®è¯†åˆ«**
- âœ… database 1.xlsx: ç¬¬73åˆ— `SolutionorMoisture` 
- âœ… database 4.xlsx: ç¬¬73åˆ— `number`ï¼ˆå®é™…ä¸Šæ˜¯åç§»åçš„ä½ç½®ï¼‰

---

**æ€»ç»“ï¼šåŸå§‹dataset codeä½¿ç”¨ç®€å•çš„"å‰132åˆ—"æ–¹æ³•ï¼Œè¿™å¯¹database 1.xlsxæœ‰æ•ˆï¼Œä½†å¯¹database 4.xlsxä¼šå¯¼è‡´ç‰¹å¾é”™ä½å’Œç¼ºå¤±ã€‚æˆ‘çš„æ™ºèƒ½è½¬æ¢å™¨é€šè¿‡æ ¼å¼æ£€æµ‹å’Œåˆ—æ˜ å°„å®Œç¾è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚**