# FRP钢筋耐久性预测系统 - 本地部署指南

## 📋 系统概述

这个项目包含三个主要应用：

1. **app.py** - 主预测应用 (Streamlit Web界面)
2. **dataset code（excel to SQL）.py** - 数据导入工具
3. **platform code.py** - 平台管理系统

## 🚀 快速开始

### 1. 环境准备

#### Python环境要求
- Python 3.8 或更高版本
- 推荐使用 Python 3.9-3.11

#### 数据库要求
- MySQL 5.7 或更高版本
- 或者 MariaDB 10.3 或更高版本

### 2. 克隆和设置项目

```bash
# 1. 进入项目目录
cd E:/大学/intern/2025-summer-concret/frp-streamlit

# 2. 创建虚拟环境（推荐）
python -m venv venv

# 3. 激活虚拟环境
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 4. 安装依赖
pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/
```

### 3. 数据库配置

#### 3.1 安装MySQL
- 下载并安装 MySQL Community Server
- 记住root用户的密码

#### 3.2 创建数据库
```sql
CREATE DATABASE haigui_database CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 3.3 配置数据库连接
编辑以下文件中的数据库配置：

**dataset code（excel to SQL）.py**:
```python
DB_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'root',
    'password': '您的MySQL密码',  # ⚠️ 修改这里
    'database': 'haigui_database',
    'charset': 'utf8mb4'
}
```

### 4. 数据导入

#### 4.1 准备Excel数据文件
确保您有以下数据文件：
- `database 1.xlsx` - 主数据文件
- `database 4.xlsx` - 扩展数据文件

#### 4.2 修改数据文件路径
在 `dataset code（excel to SQL）.py` 中修改：
```python
EXCEL_FILE_PATH = '您的Excel文件完整路径'
```

#### 4.3 执行数据导入
```bash
python "dataset code（excel to SQL）.py"
```

### 5. 运行应用

#### 5.1 运行主预测应用
```bash
streamlit run app.py
```
- 访问地址: http://localhost:8501
- 功能: FRP钢筋耐久性预测、模型训练、结果可视化

#### 5.2 运行平台管理系统
```bash
streamlit run "platform code.py"
```
- 访问地址: http://localhost:8502 (如果8501被占用)
- 功能: 系统管理、用户管理、数据管理

#### 5.3 运行数据分析应用
```bash
streamlit run app_dataset_relationship_analysis.py
```
- 功能: 数据集关系分析

## 🔧 配置文件

### 创建 .env 文件
创建 `.env` 文件用于环境变量配置：

```bash
# .env 文件内容
# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=您的MySQL密码
DB_NAME=haigui_database

# 应用配置
APP_DEBUG=True
APP_PORT=8501

# 邮件配置（如果需要）
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=your_app_password
```

## 📁 文件结构说明

```
frp-streamlit/
├── app.py                              # 主预测应用
├── app copy.py                         # 应用备份
├── platform code.py                   # 平台管理系统
├── dataset code（excel to SQL）.py    # 数据导入工具
├── app_dataset_relationship_analysis.py # 数据分析应用
├── requirements.txt                    # Python依赖
├── .env.example                        # 环境变量示例
├── Procfile                           # Heroku部署配置
├── runtime.txt                        # Python版本指定
├── frp_local - improve/               # 模型训练代码
│   ├── run_40param_experiment.py     # CatBoost实验
│   ├── run_mlp_simple.py             # MLP神经网络实验
│   └── ...
├── experiments/                       # 实验结果
├── analysis_results/                  # 分析结果
└── evaluation_results/               # 评估结果
```

## 🎯 各应用功能详解

### 1. app.py - 主预测应用
- **功能**: FRP钢筋耐久性预测
- **特点**: 
  - 交互式Web界面
  - 实时预测
  - 结果可视化
  - SHAP解释性分析
- **端口**: 8501

### 2. platform code.py - 平台管理系统
- **功能**: 系统管理和数据管理
- **特点**:
  - 用户管理
  - 数据上传和管理
  - 系统监控
  - 批量处理
- **端口**: 8502

### 3. dataset code（excel to SQL）.py - 数据导入
- **功能**: Excel数据导入MySQL
- **特点**:
  - 自动数据清洗
  - 批量导入
  - 错误处理
  - 数据验证

## 🚨 常见问题

### 1. 依赖安装问题
```bash
# 如果遇到安装问题，尝试更新pip
python -m pip install --upgrade pip

# 使用国内镜像
pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/
```

### 2. 数据库连接问题
- 确认MySQL服务已启动
- 检查用户名和密码
- 确认数据库已创建
- 检查防火墙设置

### 3. 端口占用问题
```bash
# 指定不同端口
streamlit run app.py --server.port 8503
```

### 4. 数据文件路径问题
- 使用绝对路径
- 确认文件存在
- 检查文件权限

## 🔄 更新和维护

### 更新依赖
```bash
pip install --upgrade -r requirements.txt
```

### 备份数据库
```bash
mysqldump -u root -p haigui_database > backup.sql
```

### 查看日志
应用运行时会在终端显示日志信息，注意查看错误信息。

## 🎉 成功部署检查

部署成功后，您应该能够：

1. ✅ 访问 http://localhost:8501 看到主预测界面
2. ✅ 访问 http://localhost:8502 看到平台管理界面
3. ✅ 数据库中有完整的数据表
4. ✅ 能够进行预测并看到结果
5. ✅ 图表和可视化正常显示

## 📞 技术支持

如果遇到问题：
1. 检查终端错误信息
2. 确认所有配置正确
3. 验证数据库连接
4. 检查文件路径

---

**祝您部署成功！** 🚀